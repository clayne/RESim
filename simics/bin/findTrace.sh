#!/bin/bash
#
#  Use grep to find content of syscall traces
#  generated by afl queue files.  Example:
#  findTrace.sh open "| grep -v time"
#
if [ $1 == '-h' ]; then
    echo "findTrace.sh pattern filter"
    echo "example: findTrace.sh open \"| grep -v time\""
    exit
fi
opt=""
if [ $1 == '-l' ]; then
    opt=" -l "
    shift
fi
here=$(pwd)
base=$(basename $here)
afldir=$AFL_DATA/output/$base
searchdir=$afldir/*/trace/*
cmd="grep $opt $1 $searchdir $2 | more"
eval $cmd
